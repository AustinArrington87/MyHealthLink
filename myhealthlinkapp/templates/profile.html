{% extends "base.html" %}

{% block title %}Profile{% endblock %}

{% block content %}
<div class="fixed top-0 left-0 right-0 bg-white z-50 border-b border-gray-100">
    <div class="max-w-7xl mx-auto px-4 py-3 flex justify-between items-center">
        <a href="{{ url_for('home') }}">
            <img src="{{ url_for('static', filename='img/MHL_logo.png') }}" 
                 alt="MyHealthLink Logo" 
                 class="h-8 drop-shadow-md hover:drop-shadow-lg transition-all duration-300">
        </a>
        <a href="{{ url_for('profile') }}" class="text-gray-600 hover:text-gray-900 transition-colors duration-200">Profile</a>
    </div>
</div>

<div class="max-w-4xl mx-auto">
    <h1 class="text-3xl font-bold mb-8">Profile</h1>
    
    <div class="bg-white shadow-md rounded-lg p-6">
        <h2 class="text-xl font-semibold mb-4">Contact Info</h2>
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">First Name</label>
                <input type="text" id="firstName" value="{{ user.name.first }}" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight">
            </div>
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">Last Name</label>
                <input type="text" id="lastName" value="{{ user.name.last }}" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight">
            </div>
        </div>
    </div>

    <div class="bg-white shadow-md rounded-lg p-6 mt-6">
        <h2 class="text-xl font-semibold mb-4">Vitals</h2>
        <p class="text-gray-600 mb-4">Adding your vitals is optional but can help with analysis.</p>
        
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">Blood Pressure</label>
                <input type="text" value="{{ user.vitals.blood_pressure }}" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight">
            </div>
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">BMI</label>
                <input type="text" value="{{ user.vitals.bmi }}" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight">
            </div>
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">Height</label>
                <input type="text" value="{{ user.vitals.height }}" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight">
            </div>
            <div>
                <label class="block text-gray-700 text-sm font-bold mb-2">Weight</label>
                <input type="text" value="{{ user.vitals.weight }}" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight">
            </div>
        </div>

        <div class="mt-6">
            <button onclick="saveProfile()" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
                Save
            </button>
        </div>
    </div>
</div>

<script>
function saveProfile() {
    const firstName = document.getElementById('firstName').value;
    const lastName = document.getElementById('lastName').value;
    
    fetch('/update_profile', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify({
            first_name: firstName,
            last_name: lastName
        })
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            window.location.href = '/';
        } else {
            throw new Error(data.error || 'Failed to update profile');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Failed to update profile. Please try again.');
    });
}
</script>
{% endblock %}
